(function(e){function t(t){for(var r,o,s=t[0],c=t[1],u=t[2],d=0,h=[];d<s.length;d++)o=s[d],Object.prototype.hasOwnProperty.call(i,o)&&i[o]&&h.push(i[o][0]),i[o]=0;for(r in c)Object.prototype.hasOwnProperty.call(c,r)&&(e[r]=c[r]);l&&l(t);while(h.length)h.shift()();return a.push.apply(a,u||[]),n()}function n(){for(var e,t=0;t<a.length;t++){for(var n=a[t],r=!0,s=1;s<n.length;s++){var c=n[s];0!==i[c]&&(r=!1)}r&&(a.splice(t--,1),e=o(o.s=n[0]))}return e}var r={},i={app:0},a=[];function o(t){if(r[t])return r[t].exports;var n=r[t]={i:t,l:!1,exports:{}};return e[t].call(n.exports,n,n.exports,o),n.l=!0,n.exports}o.m=e,o.c=r,o.d=function(e,t,n){o.o(e,t)||Object.defineProperty(e,t,{enumerable:!0,get:n})},o.r=function(e){"undefined"!==typeof Symbol&&Symbol.toStringTag&&Object.defineProperty(e,Symbol.toStringTag,{value:"Module"}),Object.defineProperty(e,"__esModule",{value:!0})},o.t=function(e,t){if(1&t&&(e=o(e)),8&t)return e;if(4&t&&"object"===typeof e&&e&&e.__esModule)return e;var n=Object.create(null);if(o.r(n),Object.defineProperty(n,"default",{enumerable:!0,value:e}),2&t&&"string"!=typeof e)for(var r in e)o.d(n,r,function(t){return e[t]}.bind(null,r));return n},o.n=function(e){var t=e&&e.__esModule?function(){return e["default"]}:function(){return e};return o.d(t,"a",t),t},o.o=function(e,t){return Object.prototype.hasOwnProperty.call(e,t)},o.p="/askomics-queryview/";var s=window["webpackJsonp"]=window["webpackJsonp"]||[],c=s.push.bind(s);s.push=t,s=s.slice();for(var u=0;u<s.length;u++)t(s[u]);var l=c;a.push([0,"chunk-vendors"]),n()})({0:function(e,t,n){e.exports=n("cd49")},"0c2c":function(e,t,n){"use strict";n("3d4b")},1:function(e,t){},2:function(e,t){},3:function(e,t){},"3d4b":function(e,t,n){},4:function(e,t){},4023:function(e,t,n){"use strict";n("b110")},5:function(e,t){},6:function(e,t){},7:function(e,t){},"7b2c":function(e,t,n){},"8fd5":function(e,t,n){"use strict";n("ba1f")},b110:function(e,t,n){},ba1f:function(e,t,n){},cd49:function(e,t,n){"use strict";n.r(t);n("e260"),n("e6cf"),n("cca6"),n("a79d");var r=n("7a23"),i={class:"navbar navbar-expand-lg navbar-light bg-light"},a={class:"container-fluid"},o={class:"collapse navbar-collapse"},s={class:"navbar-nav me-auto mb-2 mb-lg-0"},c={class:"nav-item"},u=Object(r["createTextVNode"])("AskOmics Query Builder "),l={class:"nav-item"},d=Object(r["createTextVNode"])("Results "),h={class:"nav-item"},p=Object(r["createTextVNode"])("Configuration "),f=Object(r["createVNode"])("form",{class:"d-flex"},[Object(r["createVNode"])("input",{class:"form-control me-2",type:"search",placeholder:"Search","aria-label":"Search"}),Object(r["createVNode"])("button",{class:"btn btn-outline-success",type:"submit"},"Search")],-1);function b(e,t,n,b,g,y){var v=Object(r["resolveComponent"])("router-link"),O=Object(r["resolveComponent"])("router-view");return Object(r["openBlock"])(),Object(r["createBlock"])(r["Fragment"],null,[Object(r["createVNode"])("nav",i,[Object(r["createVNode"])("div",a,[Object(r["createVNode"])("div",o,[Object(r["createVNode"])("ul",s,[Object(r["createVNode"])("li",c,[Object(r["createVNode"])(v,{class:"nav-link","aria-current":"page",to:{name:"askomics",params:{query:e.requestManagerStringify}}},{default:Object(r["withCtx"])((function(){return[u]})),_:1},8,["to"])]),Object(r["createVNode"])("li",l,[Object(r["createVNode"])(v,{class:"nav-link",to:{name:"results",params:{rm:e.requestManagerStringify}}},{default:Object(r["withCtx"])((function(){return[d]})),_:1},8,["to"])]),Object(r["createVNode"])("li",h,[Object(r["createVNode"])(v,{class:"nav-link",to:{name:"configuration",params:{configuration:JSON.stringify(e.configuration)}}},{default:Object(r["withCtx"])((function(){return[p]})),_:1},8,["to"])])]),f])])]),Object(r["createVNode"])(O,{onUpdateDiscovery:t[1]||(t[1]=function(t){return e.discovery=t}),onUpdateConfiguration:e.updateConfiguration},null,8,["onUpdateConfiguration"])],64)}var g,y,v,O,m=n("d4ec"),j=n("262e"),k=n("2caf"),S=n("9ab4"),w=n("ce1f"),N=n("bee2"),C=(n("ac1f"),n("5319"),n("498a"),n("1276"),n("b680"),n("d3b7"),n("25f0"),function(){function e(){Object(m["a"])(this,e)}return Object(N["a"])(e,null,[{key:"isUrl",value:function(e){var t=/(ftp|http|https):\/\/(\w+:{0,1}\w*@)?(\S+)(:[0-9]+)?(\/|\/([\w#!:.?+=&%@!\-\/]))?/;return t.test(e)}},{key:"truncate",value:function(e,t){return e.length>t?e.substring(0,t)+"...":e}},{key:"splitUrl",value:function(e){var t=e.split("/"),n=t[t.length-1],r=n.split("#");return decodeURI(r[r.length-1])}},{key:"humanFileSize",value:function(e,t){var n=t?1e3:1024;if(Math.abs(e)<n)return e+" B";var r=t?["kB","MB","GB","TB","PB","EB","ZB","YB"]:["KiB","MiB","GiB","TiB","PiB","EiB","ZiB","YiB"],i=-1;do{e/=n,++i}while(Math.abs(e)>=n&&i<r.length-1);return e.toFixed(1)+" "+r[i]}},{key:"humanDate",value:function(e){var t=new Date(1e3*e);return t.toUTCString()}},{key:"stringToHexColor",value:function(e){for(var t=0,n=0;n<e.length;n++)t=e.charCodeAt(n)+((t<<5)-t);var r=(16777215&t).toString(16).toUpperCase(),i="#"+"00000".substring(0,6-r.length)+r;return i}},{key:"isDarkColor",value:function(e){var t=e.substring(1),n=parseInt(t,16),r=n>>16&255,i=n>>8&255,a=n>>0&255,o=.2126*r+.7152*i+.0722*a;return o<128}}]),e}()),E=function(){function e(t,n,r){var i=arguments.length>3&&void 0!==arguments[3]?arguments[3]:"";Object(m["a"])(this,e),this.visible=!1,this.negative=!1,this.linked=!1,this.id=t,this.uri=n,this.label=""==i?C.splitUrl(n):i,this.range=r.trim().replace("http://www.w3.org/2001/XMLSchema#","xsd:")}return Object(N["a"])(e,[{key:"getObject",value:function(){return{id:this.id,uri:this.uri,label:this.label,range:this.range,visible:this.visible,negative:this.negative,linked:this.linked}}}],[{key:"build",value:function(e){return JSON.stringify(e.getObject())}},{key:"from",value:function(t){var n=new e(t.id,t.uri,t.range,t.label);return n.visible=t.visible,n.negative=t.negative,n.linked=t.linked,n}}]),e}();(function(e){e[e["SOMETHING"]=0]="SOMETHING",e[e["FORWARD_ENTITY"]=1]="FORWARD_ENTITY",e[e["BACKWARD_ENTITY"]=2]="BACKWARD_ENTITY"})(g||(g={})),function(e){e[e["FORWARD_PROPERTY"]=0]="FORWARD_PROPERTY",e[e["BACKWARD_PROPERTY"]=1]="BACKWARD_PROPERTY",e[e["IS_A"]=2]="IS_A"}(y||(y={})),function(e){e[e["SUGGESTED"]=0]="SUGGESTED",e[e["CONCRETE"]=1]="CONCRETE",e[e["SELECTED"]=2]="SELECTED"}(v||(v={})),function(e){e[e["TO"]=0]="TO",e[e["IS_A"]=1]="IS_A",e[e["FROM"]=2]="FROM",e[e["ALL"]=3]="ALL"}(O||(O={}));var B=function(){function e(t){Object(m["a"])(this,e),this.url="",this.file="",this.content="",this.mimetype="application/sparql-query",this.method="POST",this.strategy="data-driven",this.logLevel="info",this.id=t}return Object(N["a"])(e,[{key:"remoteAccess",value:function(){if(this.url.length>0)return'"url" : "'+this.url+'"';if(this.file.length>0)return'"file" : "'+this.file+'"';if(this.content.length>0)return'"content" : "'+this.content+'"';throw Error("url|file|content should bed defined.")}},{key:"methodAcess",value:function(){return this.method&&this.method,""}},{key:"jsonConfigurationSWDiscoveryString",value:function(){var e=this.methodAcess();return e.length>0&&(e+=",\n"),'{\n            "sources" : [{\n            "id"  : "__id__",\n'+this.remoteAccess()+",\n"+e+'"mimetype" : "'+this.mimetype+'"}],\n            "settings" : {\n                "cache" : true,\n                "logLevel" : "'+this.logLevel+'","sizeBatchProcessing" : 10,\n                "pageSize" : 10\n            }\n        }'}}],[{key:"build",value:function(t){var n=new e(t.id);return n.url=t.url,n.file=t.file,n.content=t.content,n.mimetype=t.mimetype,n.method=t.method,n.strategy=t.strategy,n.logLevel=t.logLevel,n}}]),e}(),x=function(){function e(t,n){Object(m["a"])(this,e),this.uri="",this.label="",this.id=String(e.idCounter++),this.uri=t,this.state_n=v.SUGGESTED,n.length>0?this.label=n:this.label=C.splitUrl(t)}return Object(N["a"])(e,[{key:"isSuggested",value:function(){return this.state_n==v.SUGGESTED}},{key:"isConcrete",value:function(){return this.state_n==v.CONCRETE}},{key:"isSelected",value:function(){return this.state_n==v.SELECTED}},{key:"setSuggested",value:function(){this.state_n=v.SUGGESTED}},{key:"setConcrete",value:function(){this.state_n=v.CONCRETE}},{key:"setSelected",value:function(){this.state_n=v.SELECTED}},{key:"getObject",value:function(){return Object.assign({},this)}}]),e}();x.idCounter=0;var D,R=function(e){Object(j["a"])(n,e);var t=Object(k["a"])(n);function n(e,r,i){var a;return Object(m["a"])(this,n),a=t.call(this,e,r),a.type=i,a.focus="",a}return Object(N["a"])(n,null,[{key:"something",value:function(e,t){var r=new n("something","Something",g.SOMETHING);return r.type=g.SOMETHING,r.state_n=e,r.focus=t,r}},{key:"build",value:function(e){return JSON.stringify({id:e.id,uri:e.uri,label:e.label,type:e.type,focus:e.focus,state_n:e.state_n})}}]),n}(x),q=function(e){Object(j["a"])(n,e);var t=Object(k["a"])(n);function n(e,r,i,a,o){var s;return Object(m["a"])(this,n),s=t.call(this,e,r),s.type=i,s.source=a,s.target=o,s}return Object(N["a"])(n,null,[{key:"build",value:function(e){return JSON.stringify({id:e.id,uri:e.uri,label:e.label,type:e.type,source:e.source.id,target:e.target.id,state_n:e.state_n})}}]),n}(x);(function(e){e[e["XSD_UNKNOWN"]=0]="XSD_UNKNOWN",e[e["XSD_NUMERIC"]=1]="XSD_NUMERIC",e[e["XSD_BOOLEAN"]=2]="XSD_BOOLEAN",e[e["XSD_STRING"]=3]="XSD_STRING"})(D||(D={}));var _=function(e){Object(j["a"])(n,e);var t=Object(k["a"])(n);function n(){return Object(m["a"])(this,n),t.apply(this,arguments)}return n}(w["b"]);_=Object(S["a"])([Object(w["a"])({name:"AppView",data:function(){return{discovery:"",configuration:new B("test"),requestManagerStringify:""}},watch:{discovery:function(e){this.requestManagerStringify=JSON.stringify([this.configuration.jsonConfigurationSWDiscoveryString(),this.configuration.strategy,this.discovery]),console.log("******************************LOG ==> "+e)}},created:function(){this.configuration=new B("test"),this.configuration.type="url",this.configuration.url="https://askomics-metabolights-192-168-100-98.vm.openstack.genouest.org/virtuoso/sparql",this.configuration.strategy="data-driven",this.requestManagerStringify=JSON.stringify([this.configuration.jsonConfigurationSWDiscoveryString(),this.configuration.strategy,this.discovery])},methods:{updateConfiguration:function(e){this.configuration=B.build(JSON.parse(e)),this.requestManagerStringify=JSON.stringify([this.configuration.jsonConfigurationSWDiscoveryString(),this.configuration.strategy,this.discovery])}}})],_);var P=_;P.render=b;var V=P,M=n("6c02");function T(e,t,n,i,a,o){var s=Object(r["resolveComponent"])("QueryBuilder");return Object(r["openBlock"])(),Object(r["createBlock"])(s,{query:e.query,"onUpdate:query":t[1]||(t[1]=function(t){return e.query=t}),onUpdateQuery:e.updateQuery},null,8,["query","onUpdateQuery"])}var A={id:"askomics-panel"},I={class:"container"},L=Object(r["createVNode"])("hr",null,null,-1),U=Object(r["createVNode"])("br",null,null,-1),F={class:"row"},G={class:"col col-xs-7"},J={class:"col col-xs-5"},W={class:"row"},z={class:"d-flex flex-row mb-3"},Q={class:"p-2 bd-highlight"},$={class:"p-2 bd-highlight"},Y={class:"p-2 bd-highlight"},K={class:"p-2 bd-highlight"},X={class:"p-2 bd-highlight"},H={key:0,class:"progress"};function Z(e,t,n,i,a,o){var s=Object(r["resolveComponent"])("QueryGraphPanel"),c=Object(r["resolveComponent"])("AttributesPanel"),u=Object(r["resolveComponent"])("font-awesome-icon");return Object(r["openBlock"])(),Object(r["createBlock"])("div",A,[Object(r["createVNode"])("div",I,[L,U,Object(r["createVNode"])("div",F,[Object(r["createVNode"])("div",G,[Object(r["createVNode"])(s,{requestString:e.currentQuery,"onUpdate:requestString":t[1]||(t[1]=function(t){return e.currentQuery=t}),filterProperty:e.filterProperty,"onUpdate:filterProperty":t[2]||(t[2]=function(t){return e.filterProperty=t}),onUpdateRequestManager:e.updateQuery,onRequestManagerBusy:t[3]||(t[3]=function(t){return e.requestBusy=JSON.parse(t)}),onRequestManagerBusyPercent:t[4]||(t[4]=function(t){return e.requestBusyPercent=JSON.stringify(100*JSON.parse(t))}),onRequestManagerBusyEvent:e.requestBusyEvent,width:750,height:450},null,8,["requestString","filterProperty","onUpdateRequestManager","onRequestManagerBusyEvent"])]),Object(r["createVNode"])("div",J,[Object(r["createVNode"])(c,{requestString:e.currentQuery,"onUpdate:requestString":t[5]||(t[5]=function(t){return e.currentQuery=t}),onUpdateRequestManager:e.updateQuery,onUpdateFilterProperty:t[6]||(t[6]=function(t){return e.filterProperty=JSON.parse(t)}),width:450,height:450},null,8,["requestString","onUpdateRequestManager"])])]),Object(r["createVNode"])("div",W,[Object(r["createVNode"])("div",z,[Object(r["createVNode"])("div",Q,[Object(r["createVNode"])("button",{type:"button",class:"form-control btn btn-primary",onClick:t[7]||(t[7]=function(){return e.back&&e.back.apply(e,arguments)})},"<<")]),Object(r["createVNode"])("div",$,[Object(r["createVNode"])("button",{type:"button",class:"form-control btn btn-primary",onClick:t[8]||(t[8]=function(){return e.forward&&e.forward.apply(e,arguments)})},">>")]),Object(r["createVNode"])("div",Y,[Object(r["createVNode"])("button",{type:"button",class:"form-control btn btn-primary",onClick:t[9]||(t[9]=function(){return e.getResults&&e.getResults.apply(e,arguments)})},"Results")]),Object(r["createVNode"])("div",K,[Object(r["createVNode"])("button",{type:"button",class:"form-control btn btn-primary",onClick:t[10]||(t[10]=function(){return e.forward&&e.forward.apply(e,arguments)})},"URL")]),Object(r["createVNode"])("div",X,[e.requestBusy?(Object(r["openBlock"])(),Object(r["createBlock"])(u,{key:0,icon:"spinner",size:"2x",spin:""})):Object(r["createCommentVNode"])("",!0)])]),e.requestBusy?(Object(r["openBlock"])(),Object(r["createBlock"])("div",H,[Object(r["createVNode"])("div",{class:"progress-bar",role:"progressbar",style:"width: "+e.requestBusyPercent+"%","aria-valuenow":"100","aria-valuemin":"0","aria-valuemax":"100"},Object(r["toDisplayString"])(e.requestBusyPercent)+" "+Object(r["toDisplayString"])(e.requestBusyEvent),5)])):Object(r["createCommentVNode"])("",!0)])])])}n("d81d"),n("ab8b");var ee=n("ecee"),te=n("c074"),ne=n("ad3d");function re(e,t,n,i,a,o){return Object(r["openBlock"])(),Object(r["createBlock"])("div",{id:"query-graph-panel",class:e.canvasClass},[Object(r["createVNode"])("canvas",{id:"canvas-askomics-graph",width:e.width,height:e.height,disabled:""},null,8,["width","height"])],2)}var ie,ae=n("2909"),oe=n("b85c"),se=(n("a9e3"),n("4de4"),n("159b"),n("7db0"),n("3ca3"),n("ddb0"),n("99af"),n("cb29"),n("898b")),ce=n("3835"),ue=(n("4ec9"),n("5db7"),n("73d9"),n("6062"),n("c527")),le=function(){function e(){Object(m["a"])(this,e)}return Object(N["a"])(e,[{key:"getDatatypesWithProperty",value:function(e,t){return new Promise((function(n,r){Object(ue["SWDiscovery"])(ue["SWDiscoveryConfiguration"].setConfigString(e)).something().isSubjectOf(new ue["URI"](t),"valueL").select("valueL").limit(5).commit().raw().then((function(e){try{var i=Object(ae["a"])(new Set(e.results.bindings.map((function(e){return e["valueL"].datatype}))));i[0]?n([t,i[0]]):n([t,"xsd:string"])}catch(a){r(a)}}))}))}},{key:"getDatatypes",value:function(e,t){var n=this,r=Object(ae["a"])(new Set(t)),i=new Map;return new Promise((function(t,a){Promise.all(r.map((function(t){return n.getDatatypesWithProperty(e,t)}))).then((function(e){e.map((function(e){return i.set(e[0],e[1])})),t(i)})).catch((function(e){a(e)}))}))}}]),e}(),de=function(e){Object(j["a"])(n,e);var t=Object(k["a"])(n);function n(e){var r;return Object(m["a"])(this,n),r=t.call(this),r.askomics_prefix="http://askomics.org/internal/",console.log(" ============ StrategyRequestAskOmics ============ "),r.config_endp=e,r}return Object(N["a"])(n,[{key:"attributeList",value:function(e,t){return e.focus(t).isSubjectOf(new ue["URI"]("rdf:type"),"typeFocus").isObjectOf(new ue["URI"]("rdfs:domain"),"property").isA("owl:DatatypeProperty").datatype(new ue["URI"]("http://www.w3.org/2000/01/rdf-schema#label"),"labelProperty").isSubjectOf(new ue["URI"]("rdfs:range"),"range")}},{key:"forwardEntities",value:function(e,t,n){var r=new ue["SWDiscovery"](ue["SWDiscoveryConfiguration"].setConfigString(t)).something();return n.type!=g.SOMETHING&&(r=r.set(new ue["URI"](n.uri))),r.isObjectOf(new ue["URI"]("rdfs:domain"),"property").isA(this.askomics_prefix+"AskomicsRelation").datatype(new ue["URI"]("http://www.w3.org/2000/01/rdf-schema#label"),"labelProperty").isSubjectOf(new ue["URI"]("rdfs:range"),"entity").datatype(new ue["URI"]("http://www.w3.org/2000/01/rdf-schema#label"),"labelEntity")}},{key:"backwardEntities",value:function(e,t,n){var r=new ue["SWDiscovery"](ue["SWDiscoveryConfiguration"].setConfigString(t)).something();return n.type!=g.SOMETHING&&(r=r.set(new ue["URI"](n.uri))),r.isObjectOf(new ue["URI"]("rdfs:range"),"property").isA(this.askomics_prefix+"AskomicsRelation").datatype(new ue["URI"]("http://www.w3.org/2000/01/rdf-schema#label"),"labelProperty").isSubjectOf(new ue["URI"]("rdfs:domain"),"entity").datatype(new ue["URI"]("http://www.w3.org/2000/01/rdf-schema#label"),"labelEntity")}}]),n}(le),he=function(e){Object(j["a"])(n,e);var t=Object(k["a"])(n);function n(){var e;return Object(m["a"])(this,n),e=t.call(this),console.log(" ============ StrategyRequestDataDriven ============ "),e}return Object(N["a"])(n,[{key:"attributeList",value:function(e,t){return e.focus(t).isLinkTo(new ue["QueryVariable"]("value"),"property").root().something("value").filter.isLiteral.focus("property").datatype(new ue["URI"]("rdfs:label"),"labelProperty")}},{key:"forwardEntities",value:function(e,t,n){return e.isSubjectOf(new ue["QueryVariable"]("property")).isSubjectOf(new ue["URI"]("rdf:type"),"entity").filter.not.strStarts(new ue["Literal"]("http://www.openlinksw.com/")).datatype(new ue["URI"]("rdfs:label"),"labelEntity").focus("property").filter.notEqual("rdf:type").filter.notEqual("rdfs:domain").filter.notEqual("rdfs:range").filter.not.strStarts(new ue["Literal"]("http://www.openlinksw.com/")).datatype(new ue["URI"]("rdfs:label"),"labelProperty")}},{key:"backwardEntities",value:function(e,t,n){return e.filter.isUri.isObjectOf(new ue["QueryVariable"]("property")).isSubjectOf(new ue["URI"]("rdf:type"),"entity").filter.not.strStarts(new ue["Literal"]("http://www.openlinksw.com/")).datatype(new ue["URI"]("rdfs:label"),"labelEntity").focus("property").filter.notEqual("rdf:type").filter.notEqual("rdfs:domain").filter.notEqual("rdfs:range").filter.not.strStarts(new ue["Literal"]("http://www.openlinksw.com/")).datatype(new ue["URI"]("rdfs:label"),"labelProperty")}}]),n}(le);function pe(e){var t=ie.get(e);return t||new ue["SWDiscovery"]}var fe=function(){function e(t){Object(m["a"])(this,e),this.id=e.idCounter++,this.config_str="",this.strategy_str="",this.strategy=new he,this.discovery=null,ie||(ie=new Map),this.parse(t)}return Object(N["a"])(e,[{key:"defaultGraph",value:function(e){return{nodes:[R.something(v.CONCRETE,e)],links:[]}}},{key:"serialized",value:function(){return JSON.stringify([this.config_str,this.strategy_str,this.getDiscovery().getSerializedString()])}},{key:"parse",value:function(e){if(!e||e.length<=0)throw new Error("Non string to parse !");var t=JSON.parse(e);this.config_str=t[0],this.config=ue["SWDiscoveryConfiguration"].setConfigString(this.config_str),this.strategy_str=t[1];var n=t[2],r=Object(ue["SWDiscovery"])(this.config);if(n&&n.length>0)r=r.setSerializedString(n);else{var i=this.defaultGraph("start").nodes[0];r=r.something("start").setDecoration("node",R.build(i)).setDecoration("attributes",JSON.stringify(Object(ae["a"])(new Map)))}switch(this.setDiscovery(r),this.strategy_str){case"askomics":this.setAskOmicsStrategy();break;case"data-driven":this.setDataDrivenStrategy();break;default:console.warn("strategy unknown : "+this.strategy_str),this.setDataDrivenStrategy()}}},{key:"setDiscovery",value:function(e){ie.set(this.id,e)}},{key:"getDiscovery",value:function(){return pe(this.id)}},{key:"update",value:function(e,t){var n=t.source.id==e.id?t.source:t.target,r=this.getDiscovery();switch(t.type){case y.FORWARD_PROPERTY:this.setDiscovery(r.isSubjectOf(new ue["URI"](t.uri)).isA(new ue["URI"](n.uri))),e.state_n=v.CONCRETE,e.focus=this.getDiscovery().focus(),this.setDiscovery(this.getDiscovery().setDecoration("link",q.build(t)).setDecoration("node",R.build(e)).setDecoration("attributes",JSON.stringify(Object(ae["a"])(new Map))));break;case y.BACKWARD_PROPERTY:this.setDiscovery(r.isObjectOf(new ue["URI"](t.uri)).isA(new ue["URI"](n.uri))),e.state_n=v.CONCRETE,e.focus=this.getDiscovery().focus(),this.setDiscovery(this.getDiscovery().setDecoration("link",q.build(t)).setDecoration("node",R.build(e)).setDecoration("attributes",JSON.stringify(Object(ae["a"])(new Map))));break;case y.IS_A:this.setDiscovery(r.isA(new ue["URI"](n.uri)));break;default:console.error("unkown action :"+JSON.stringify(t));break}return this.getDiscovery().focus()}},{key:"setPageSize",value:function(e){var t=/("pageSize"\s*:\s*)(\d+)/;this.config_str=this.config_str.replace(t,"$1"+e),console.log(this.config_str),this.config=ue["SWDiscoveryConfiguration"].setConfigString(this.config_str);var n=this.getDiscovery();this.setDiscovery(n.setConfig(this.config))}},{key:"focusIsSelected",value:function(){return this.getFocus()!=this.getDiscovery().root().focus()}},{key:"isFocusStart",value:function(){return"start"==this.getFocus()}},{key:"setAskOmicsStrategy",value:function(){console.log(" -- setAskOmicsStrategy -- "),this.strategy=new de(this.config)}},{key:"setDataDrivenStrategy",value:function(){console.log(" -- setDataDrivenStrategy -- "),this.strategy=new he}},{key:"getFocus",value:function(){return this.getDiscovery().focus()}},{key:"setFocusRoot",value:function(){var e=this.getDiscovery().root();this.setDiscovery(e)}},{key:"setFocus",value:function(e){var t=this.getDiscovery().focus(e);this.setDiscovery(t)}},{key:"checkVariablePresent",value:function(e,t,n){for(var r=0;r<n.length;r++){var i=n[r];if(!e.results.bindings[t][i])return console.warn(" probleme with entry : "+JSON.stringify(e.results.bindings[t])),!1}return!0}},{key:"removeNode",value:function(e){this.focusIsSelected()?(this.setDiscovery(this.getDiscovery().remove(this.getDiscovery().focus())),e.$emit("updateRequestManager",this.serialized())):console.warn("None node is selected !")}},{key:"updateAttribute",value:function(e){var t=new Map(JSON.parse(this.getDiscovery().getDecoration("attributes")));t=t.set(e.uri,e),e.visible&&this.setDiscovery(this.getDiscovery().datatype(e.uri,e.id)),this.setDiscovery(this.getDiscovery().setDecoration("attributes",JSON.stringify(Object(ae["a"])(t))))}},{key:"attributeList",value:function(e){var t=this;return new Promise((function(n,r){t.strategy&&t.strategy.attributeList(t.getDiscovery(),e).select("property","labelProperty").distinct().commit().raw().then((function(i){for(var a=[],o=new Map,s=0;s<i.results.bindings.length;s++)if(t.checkVariablePresent(i,s,["property"])){var c=i.results.bindings[s]["property"].value,u=C.splitUrl(c);try{var l=i.results.datatypes["labelProperty"][c];l&&(u=l[0].value)}catch(b){r(b)}o.set(c,u)}if(t.strategy&&o.size>0){var d,h=[],p=Object(oe["a"])(o.keys());try{for(p.s();!(d=p.n()).done;){var f=d.value;h.push(f)}}catch(g){p.e(g)}finally{p.f()}t.strategy.getDatatypes(t.config_str,h).then((function(t){var r=0;h.map((function(n){var i=o.get(n),s=t.get(n);i||(i=n.split(/\/#/).pop()),i||(i=""),s||(s="");var c=e+"_dt_"+r++;a.push(new E(c,n,s,i))})),n(a)})).catch((function(e){r(e)}))}else n(a)})).catch((function(e){r(e)}))}))}},{key:"forwardEntities",value:function(e,t){return this.propertyEntities(e,g.FORWARD_ENTITY,t)}},{key:"backwardEntities",value:function(e,t){return this.propertyEntities(e,g.BACKWARD_ENTITY,t)}},{key:"propertyEntities",value:function(e,t,n){var r=this;return new Promise((function(i,a){if(r.strategy){var o,s=r.getDiscovery();switch(t){case g.FORWARD_ENTITY:s=r.strategy.forwardEntities(r.getDiscovery(),r.config_str,n),o=y.FORWARD_PROPERTY;break;case g.BACKWARD_ENTITY:s=r.strategy.backwardEntities(r.getDiscovery(),r.config_str,n),o=y.BACKWARD_PROPERTY;break;default:return void a("unkown action :"+t)}try{var c=s.select("property","entity","labelEntity","labelProperty").distinct().commit().progression((function(t){e.$emit("requestManagerBusyPercent",JSON.stringify(t))})).requestEvent((function(t){e.$emit("requestManagerBusyEvent",JSON.stringify(t))}));c.raw().then((function(e){for(var a=new Map,s=0;s<e.results.bindings.length;s++)if(r.checkVariablePresent(e,s,["entity","property"])){var c=e.results.bindings[s]["entity"].value,u=e.results.bindings[s]["property"].value,l="",d="",h=void 0;if(a.has(c))h=a.get(c);else{try{var p=e.results.datatypes["labelEntity"][c];p&&(l=p[0].value)}catch(b){console.warn(b)}h=new R(c,l,t),a.set(c,h)}if(!a.has(c+u)){try{var f=e.results.datatypes["labelProperty"][u];f&&(d=f[0].value)}catch(b){console.warn(b)}o==y.FORWARD_PROPERTY?a.set(c+u,new q(u,d,o,n.id,h.id)):a.set(c+u,new q(u,d,o,h.id,n.id))}}i(a)})).catch((function(e){a(e)}))}catch(u){a(u)}}else a("strategy undefined.")}))}},{key:"getColumnsResults",value:function(){console.log(" --- getColumnsResults ---"),console.log(this.config_str);var e=this.getDiscovery(),t=e.browse((function(e,t){if(e.decorations&&e.decorations.attributes){var n,r=new Map(JSON.parse(e.decorations.attributes)),i=Object(oe["a"])(r);try{for(i.s();!(n=i.n()).done;){var a=Object(ce["a"])(n.value,2),o=(a[0],a[1]);if(o.visible)return{node_id:e.idRef,label:o.label,field:o.id,width:"3%",sortable:!0,isKey:!1}}}catch(s){i.e(s)}finally{i.f()}}})).filter((function(e){return e}));return console.log(t),t}},{key:"getCountAndLaziesPages",value:function(){var e=this,t=arguments.length>0&&void 0!==arguments[0]?arguments[0]:10,n=this.getColumnsResults().flatMap((function(e){return[e.node_id,e.field]})),r=Object(ae["a"])(new Set(n));return this.setPageSize(t),new Promise((function(t,n){var i;(i=e.getDiscovery().console()).selectByPage.apply(i,Object(ae["a"])(r)).then((function(e){t(e)})).catch((function(e){n(e)}))}))}}]),e}();fe.idCounter=0;var be,ge,ye=function(){function e(){Object(m["a"])(this,e)}return Object(N["a"])(e,null,[{key:"releaseSelectedObject",value:function(e){return e.nodes=e.nodes.map((function(e){return e.state_n==v.SELECTED&&(e.state_n=v.CONCRETE),e})),e.links=e.links.map((function(e){return e.state_n==v.SELECTED&&(e.state_n=v.CONCRETE),e})),e}},{key:"clickNodeForward",value:function(e,t,n){return e.$emit("requestManagerBusy",JSON.stringify(!0)),new Promise((function(r,i){t.forwardEntities(e,n).then((function(t){var n=[],i=[];t.forEach((function(e,t){var r=Object.assign({},e);e instanceof R?n.push(r):e instanceof q&&i.push(r)})),e.$emit("requestManagerBusy",JSON.stringify(!1)),r([n,i])})).catch((function(t){e.$emit("requestManagerBusy",JSON.stringify(!1)),i(t)}))}))}},{key:"clickNodeBackward",value:function(e,t,n){return e.$emit("requestManagerBusy",JSON.stringify(!0)),new Promise((function(r,i){t.backwardEntities(e,n).then((function(t){var n=[],i=[];t.forEach((function(e,t){var r=Object.assign({},e);e instanceof R?n.push(r):e instanceof q&&i.push(r)})),e.$emit("requestManagerBusy",JSON.stringify(!1)),r([n,i])})).catch((function(t){e.$emit("requestManagerBusy",JSON.stringify(!1)),i(t)}))}))}},{key:"setShapeNode",value:function(e,t,n){return t.state_n==v.SELECTED?n:t.state_n==v.CONCRETE?(t.focus&&t.focus.length>0&&(n.nodes=n.nodes.map((function(n){return n.id==t.id&&(n.state_n=v.SELECTED,e.setFocus(t.focus)),n}))),n):(n.links=n.links.map((function(r){if(r.state_n==v.SUGGESTED&&(r.source.id==t.id||r.target.id==t.id)){r.state_n=v.CONCRETE;var i=e.update(t,r);n.nodes=n.nodes.map((function(e){return e.id==t.id&&(e.focus=i),e}))}return r})),n.nodes=n.nodes.map((function(e){return e.id==t.id&&(e.state_n=v.SELECTED),e})),n)}},{key:"removeSuggestion",value:function(e){return e.nodes=e.nodes.filter((function(e){return e.state_n!=v.SUGGESTED})),e.links=e.links.filter((function(e){return e.state_n!=v.SUGGESTED})),e}}]),e}(),ve=(n("9911"),function(){function e(){Object(m["a"])(this,e)}return Object(N["a"])(e,null,[{key:"emptyGraph",value:function(){return{nodes:[],links:[]}}},{key:"build3DJSGraph",value:function(t){var n=e.emptyGraph();if(t.getDiscovery().browse((function(e,t){console.log("-- browse -- "),console.log(e),e.decorations&&(e.decorations.node&&n.nodes.push(JSON.parse(e.decorations.node)),e.decorations.link&&n.links.push(JSON.parse(e.decorations.link)))})),console.log("----------------------------------------------"),console.log(n),n.nodes.length<=0&&n.links.length<=0)throw Error("Can not handle empty graph");return n}},{key:"buildAttributesBox",value:function(e){return new Promise((function(t,n){e.getDiscovery().browse((function(r,i){if(r.idRef==e.getFocus()){var a=JSON.parse(r.decorations.node),o=r.decorations.attributes?new Map(JSON.parse(r.decorations.attributes)):new Map;e.attributeList(e.getFocus()).then((function(e){var n="uri",r=o.has(n)?E.from(o.get(n)):new E(n,a.uri,"uri",a.label),i=e.map((function(e){return o.has(e.uri)?E.from(o.get(e.uri)):e})).map((function(e){return e.getObject()}));i.unshift(r),t(i)})).catch((function(e){n(e)}))}}))}))}}]),e}()),Oe=(be=Object(w["a"])({name:"QueryGraphPanel",emits:["updateRequestManager","requestManagerBusy","requestManagerBusyEvent","requestManagerBusyPercent"],components:{},props:{requestString:{type:String,required:!0},filterProperty:O,width:Number,height:Number},data:function(){return{ctrlKey:!1,canvas:null,ctx:null,color:se["h"](["#6b486b","#a05d56","#d0743c","#ff8c00"]),zoom:5,zoomTime:1e3,trans:se["j"],colorGrey:"#808080",colorDarkGrey:"#404040",colorFirebrick:"#cc0000",lineWidth:2.5,nodeSize:17,textSize:12,blankNodeSize:1,arrowLength:40,forceCollide:40,strengthForce:1,strengthForceManBody:-2e3,alphaTarget:0,canvasClass:"",graph:{nodes:[],links:[]},request:null,selectedNodeCanvas:null}},mounted:function(){this.request=new fe(this.requestString),this.graph=ve.build3DJSGraph(this.request),this.setUpCanvas()},beforeDestroy:function(){},watch:{requestString:function(){this.request=new fe(this.requestString),this.graph=ve.build3DJSGraph(this.request),this.updateCanvas(this.selectedNodeCanvas)},filterProperty:function(){this.updateCanvas(this.selectedNodeCanvas)}},computed:{selectedNode:function(){return this.graph.nodes.filter((function(e){return e.state_n==v.SELECTED})).pop()}},methods:{setUpCanvas:function(){this.canvas=se["i"]("#canvas-askomics-graph"),this.ctx=this.canvas.node().getContext("2d"),this.simulation=se["e"]().force("x",se["f"](this.width/2).strength(this.strengthForce)).force("y",se["g"](this.height/2).strength(this.strengthForce)).force("collide",se["b"](this.nodeSize+this.forceCollide)).force("charge",se["d"]().strength(this.strengthForceManBody)),this.simulation.on("tick",this.update),this.canvas.on("click",this.canvasClick).call(se["a"]().container(this.canvas.node()).subject(this.dragsubject).on("start",this.dragstarted).on("drag",this.dragged).on("end",this.dragended))},update:function(){this.graph&&this.graph.nodes&&this.graph.links?(this.ctx.clearRect(0,0,this.width,this.height),this.ctx.fillStyle="Gainsboro",this.ctx.fillRect(0,0,this.width,this.height),this.ctx.beginPath(),this.ctx.globalAlpha=1,this.ctx.strokeStyle="#aaa",this.graph.links.forEach(this.drawLink),this.ctx.stroke(),this.ctx.globalAlpha=1,this.graph.nodes.forEach(this.drawNode),this.simulation.nodes(this.graph.nodes),this.simulation.force("link",se["c"]().id((function(e){return e.id}))).force("link").links(this.graph.links),this.simulation.restart()):console.error("graph is not initialized.")},zoomed:function(e){this.ctx.translate(e.transform.x,e.transform.y),this.ctx.scale(e.transform.k,e.transform.k)},dragsubject:function(e){return this.simulation.find(e.x,e.y)},updateCanvas:function(e){e?(console.log(" ---  SELECTED NODE / updateCanvas/UserIncrementManager.setShapeNode --- "),this.graph=ye.setShapeNode(this.request,e,this.graph),console.log(" ---  SELECTED NODE / updateCanvas/UserIncrementManager.removeSuggestion --- "),this.graph=ye.removeSuggestion(this.graph),this.lock_suggestions()):(console.log(" ---  UNSELECTED NODE / updateCanvas/UserIncrementManager.removeSuggestion --- "),this.graph=ye.removeSuggestion(this.graph),this.request.setFocusRoot(),this.$emit("updateRequestManager",this.request.serialized())),this.$emit("updateRequestManager",this.request.serialized()),this.update()},canvasClick:function(e){console.log("------------------ canvasClick ---------------"),e.ctrlKey||(this.graph=ye.releaseSelectedObject(this.graph));var t=this.canvas.node().getBoundingClientRect();this.selectedNodeCanvas=this.simulation.find(e.x-t.left,e.y-t.top,this.nodeSize),this.updateCanvas(this.selectedNodeCanvas)},lock_suggestions:function(){var e=this;if(this.selectedNode){var t=this.graph,n=this;n.canvasClass="query-graph-panel-disabled";var r=[];switch(this.filterProperty){case O.ALL:r=[ye.clickNodeForward(this,this.request,this.selectedNode),ye.clickNodeBackward(this,this.request,this.selectedNode)];break;case O.TO:r=[ye.clickNodeForward(this,this.request,this.selectedNode)];break;case O.FROM:r=[ye.clickNodeBackward(this,this.request,this.selectedNode)];break;case O.IS_A:r=[];break}Promise.all(r).then((function(r){console.log("----------------------lock_suggestions----------------------------");var i,a=Object(oe["a"])(r);try{for(a.s();!(i=a.n()).done;){var o=i.value;console.log(JSON.stringify(o)),console.log("--------------------------------------------------"),n.graph.nodes=t.nodes.concat(o[0]),n.graph.links=t.links.concat(o[1]),t=e.graph}}catch(s){a.e(s)}finally{a.f()}n.graph=t,n.canvasClass=""})).catch((function(e){alert(e)})).finally((function(){n.canvasClass="",n.update()}))}},dragstarted:function(e){e.active||this.simulation.alphaTarget(.3).restart(),e.subject.fx=e.subject.x,e.subject.fy=e.subject.y},dragged:function(e){e.subject.fx=e.x,e.subject.fy=e.y},dragended:function(e){e.active||this.simulation.alphaTarget(0),e.subject.fx=null,e.subject.fy=null},IntersectionCoordinate:function(e,t,n,r,i){var a,o,s=Math.atan((r-t)/(e-n));return e<n?(a=e+i*Math.cos(s),o=t-i*Math.sin(s)):(a=e-i*Math.cos(s),o=t+i*Math.sin(s)),{x:a,y:o}},middleCoordinate:function(e,t,n,r){var i,a,o=Math.atan((r-t)/(e-n));return e<n?(i=e+4*this.nodeSize*Math.cos(o),a=t-4*this.nodeSize*Math.sin(o)):(i=e-4*this.nodeSize*Math.cos(o),a=t+4*this.nodeSize*Math.sin(o)),{x:i,y:a}},triangleCoordinate:function(e,t,n,r,i){var a=Math.atan2(t-r,e-n),o=e-i*Math.cos(a-Math.PI/14),s=t-i*Math.sin(a-Math.PI/14),c=e-i*Math.cos(a+Math.PI/14),u=t-i*Math.sin(a+Math.PI/14);return{xa:o,ya:s,xb:c,yb:u}},subNums:function(e){var t="",n=e.toString(),r=Object(ae["a"])(n);return r.forEach((function(e){var n=e.charCodeAt();t+=String.fromCharCode(n+8272)})),t},drawNode:function(e){var t=this.colorGrey,n=this.colorDarkGrey;this.ctx.fillStyle=e.uri?C.stringToHexColor(e.uri):"#faaafff",this.ctx.lineWidth=this.lineWidth,this.ctx.strokeStyle=e.state_n==v.SELECTED?this.colorFirebrick:t,this.ctx.globalAlpha=e.state_n==v.SUGGESTED?.5:1,e.state_n==v.SUGGESTED?this.ctx.setLineDash([this.lineWidth,this.lineWidth]):this.ctx.setLineDash([]),this.ctx.beginPath(),this.ctx.arc(e.x,e.y,this.nodeSize,0,2*Math.PI,!1),this.ctx.stroke(),this.ctx.fill(),this.ctx.closePath(),this.ctx.beginPath(),this.ctx.fillStyle=n,this.ctx.font=this.nodeSize+"px Sans-Serif",this.ctx.textAlign="middle",this.ctx.textBaseline="middle";var r=e.humanId?e.label+" "+this.subNums(e.humanId):e.label;this.ctx.fillText(r,e.x+this.nodeSize,e.y+this.nodeSize),this.ctx.closePath()},drawLink:function(e){e.state_n==v.SUGGESTED?this.ctx.setLineDash([this.lineWidth,this.lineWidth]):this.ctx.setLineDash([]);var t=this.colorGrey,n=this.colorDarkGrey;this.ctx.strokeStyle=e.state_n==v.SELECTED?this.colorFirebrick:t,this.ctx.fillStyle=e.state_n==v.SELECTED?this.colorFirebrick:this.colorGrey,this.ctx.globalAlpha=e.state_n==v.SUGGESTED?.3:1,this.ctx.lineWidth=this.lineWidth,this.ctx.beginPath();var r=this.IntersectionCoordinate(e.source.x,e.source.y,e.target.x,e.target.y,this.nodeSize);if(this.ctx.moveTo(r.x,r.y),r=this.IntersectionCoordinate(e.target.x,e.target.y,e.source.x,e.source.y,this.nodeSize),this.ctx.lineTo(r.x,r.y),this.ctx.stroke(),this.ctx.closePath(),e.type==y.FORWARD_PROPERTY||e.type==y.BACKWARD_PROPERTY){this.ctx.beginPath();var i=this.triangleCoordinate(e.target.x,e.target.y,e.source.x,e.source.y,this.arrowLength);this.ctx.moveTo(r.x,r.y),this.ctx.lineTo(i.xa,i.ya),this.ctx.lineTo(i.xb,i.yb),this.ctx.fill(),this.ctx.closePath()}this.ctx.beginPath(),this.ctx.fillStyle=n,this.ctx.font=this.textSize+"px Sans-Serif",this.ctx.textAlign="middle",this.ctx.textBaseline="middle";var a=this.middleCoordinate(e.source.x,e.source.y,e.target.x,e.target.y);this.ctx.fillText(e.label,a.x,a.y),this.ctx.closePath()}}}),be(ge=function(e){Object(j["a"])(n,e);var t=Object(k["a"])(n);function n(){return Object(m["a"])(this,n),t.apply(this,arguments)}return n}(w["b"]))||ge);n("e3f0");Oe.render=re;var me=Oe,je={id:"attributes-panel",class:"attributesList"},ke={class:"d-flex justify-content-end"},Se={class:"btn-group btn-group-sm",role:"group","aria-label":"Basic example"},we={key:0,id:"v-model-select-property",class:"form-control"},Ne={key:1,type:"button",class:"form-control btn btn-secondary",disabled:""};function Ce(e,t,n,i,a,o){var s=Object(r["resolveComponent"])("attributeBox");return Object(r["openBlock"])(),Object(r["createBlock"])("div",je,[Object(r["createVNode"])("div",ke,[Object(r["createVNode"])("div",Se,[Object(r["createVNode"])("div",null,[e.displayCommonAttributeButtons?(Object(r["openBlock"])(),Object(r["createBlock"])("div",we,[Object(r["withDirectives"])(Object(r["createVNode"])("select",{"onUpdate:modelValue":t[1]||(t[1]=function(t){return e.selected_filterProperty=t})},[(Object(r["openBlock"])(!0),Object(r["createBlock"])(r["Fragment"],null,Object(r["renderList"])(e.propertyFilterList,(function(e){return Object(r["openBlock"])(),Object(r["createBlock"])("option",{key:e.id,value:e.id},Object(r["toDisplayString"])(e.label),9,["value"])})),128))],512),[[r["vModelSelect"],e.selected_filterProperty]])])):Object(r["createCommentVNode"])("",!0)]),Object(r["createVNode"])("div",null,[e.displayRemoveButton?(Object(r["openBlock"])(),Object(r["createBlock"])("button",{key:0,type:"button",class:"form-control btn btn-secondary",onClick:t[2]||(t[2]=function(){return e.removeNode&&e.removeNode.apply(e,arguments)})},"Remove")):(Object(r["openBlock"])(),Object(r["createBlock"])("button",Ne,"Remove"))])])]),(Object(r["openBlock"])(!0),Object(r["createBlock"])(r["Fragment"],null,Object(r["renderList"])(e.attributeList,(function(t){return Object(r["openBlock"])(),Object(r["createBlock"])(s,{key:t.id,attribute:t,onUpdateAttribute:e.updateAttribute},null,8,["attribute","onUpdateAttribute"])})),128))])}n("caad");var Ee={class:"attr-label"},Be={className:"attr-icons"},xe={key:0},De={key:1},Re={key:2},qe={key:3};function _e(e,t,n,i,a,o){var s=Object(r["resolveComponent"])("font-awesome-icon"),c=Object(r["resolveComponent"])("URIBox"),u=Object(r["resolveComponent"])("XsdString"),l=Object(r["resolveComponent"])("XsdNumeric");return Object(r["openBlock"])(),Object(r["createBlock"])("div",{id:e.attributeInt.id,class:"attribute-box"},[Object(r["createVNode"])("label",Ee,Object(r["toDisplayString"])(e.attributeInt.label),1),Object(r["createVNode"])("div",Be,[e.attributeInt.linked?(Object(r["openBlock"])(),Object(r["createBlock"])(s,{key:0,onClick:e.closeLink,icon:["fas","link"]},null,8,["onClick"])):(Object(r["openBlock"])(),Object(r["createBlock"])(s,{key:1,onClick:e.openLink,icon:["fas","unlink"]},null,8,["onClick"])),e.attributeInt.visible?(Object(r["openBlock"])(),Object(r["createBlock"])(s,{key:2,onClick:e.closeEye,icon:["fas","eye"]},null,8,["onClick"])):(Object(r["openBlock"])(),Object(r["createBlock"])(s,{key:3,onClick:e.openEye,icon:["fas","eye-slash"]},null,8,["onClick"]))]),"uri"==e.attributeInt.range?(Object(r["openBlock"])(),Object(r["createBlock"])("div",xe,[Object(r["createVNode"])(c)])):"xsd:string"==e.attributeInt.range?(Object(r["openBlock"])(),Object(r["createBlock"])("div",De,[Object(r["createVNode"])(u,{attribute:e.attributeInt},null,8,["attribute"])])):["xsd:numeric","xsd:double","xsd:float","xsd:integer"].includes(e.attributeInt.range)?(Object(r["openBlock"])(),Object(r["createBlock"])("div",Re,[Object(r["createVNode"])(l,{attribute:e.attributeInt},null,8,["attribute"])])):(Object(r["openBlock"])(),Object(r["createBlock"])("div",qe,Object(r["toDisplayString"])(e.attributeInt.range)+" is not supported ! ",1))],8,["id"])}var Pe={id:"askomics-uri-box"};function Ve(e,t,n,i,a,o){return Object(r["openBlock"])(),Object(r["createBlock"])("div",Pe,[Object(r["createVNode"])("table",null,[Object(r["createVNode"])("tr",null,[Object(r["createVNode"])("td",null,[Object(r["withDirectives"])(Object(r["createVNode"])("select",{"onUpdate:modelValue":t[1]||(t[1]=function(t){return e.typeSearch=t})},[(Object(r["openBlock"])(!0),Object(r["createBlock"])(r["Fragment"],null,Object(r["renderList"])(e.optionsTypeSearch,(function(e){return Object(r["openBlock"])(),Object(r["createBlock"])("option",{key:e.value,value:e.value},Object(r["toDisplayString"])(e.text),9,["value"])})),128))],512),[[r["vModelSelect"],e.typeSearch]])]),Object(r["createVNode"])("td",null,[Object(r["withDirectives"])(Object(r["createVNode"])("select",{"onUpdate:modelValue":t[2]||(t[2]=function(t){return e.typeCompare=t})},[(Object(r["openBlock"])(!0),Object(r["createBlock"])(r["Fragment"],null,Object(r["renderList"])(e.optionsTypeCompare,(function(e){return Object(r["openBlock"])(),Object(r["createBlock"])("option",{key:e.value,value:e.value},Object(r["toDisplayString"])(e.text),9,["value"])})),128))],512),[[r["vModelSelect"],e.typeCompare]])]),Object(r["createVNode"])("td",null,[Object(r["withDirectives"])(Object(r["createVNode"])("input",{"onUpdate:modelValue":t[3]||(t[3]=function(t){return e.filterValue=t}),placeholder:"edit me"},null,512),[[r["vModelText"],e.filterValue]])])])])])}var Me=function(e){Object(j["a"])(n,e);var t=Object(k["a"])(n);function n(){return Object(m["a"])(this,n),t.apply(this,arguments)}return n}(w["b"]);Me=Object(S["a"])([Object(w["a"])({name:"URIBox",props:{},methods:{},data:function(){return{visible:!1,linked:!1,typeSearch:"A",optionsTypeSearch:[{text:"Exact",value:"A"},{text:"Regex",value:"B"}],typeCompare:"A",optionsTypeCompare:[{text:"=",value:"A"},{text:"!=",value:"B"}],filterValue:""}}})],Me);var Te=Me;Te.render=Ve;var Ae=Te,Ie={id:"askomics-text-box"};function Le(e,t,n,i,a,o){return Object(r["openBlock"])(),Object(r["createBlock"])("div",Ie,[Object(r["createVNode"])("table",null,[Object(r["createVNode"])("tr",null,[Object(r["createVNode"])("td",null,[Object(r["withDirectives"])(Object(r["createVNode"])("select",{"onUpdate:modelValue":t[1]||(t[1]=function(t){return e.typeSearch=t})},[(Object(r["openBlock"])(!0),Object(r["createBlock"])(r["Fragment"],null,Object(r["renderList"])(e.optionsTypeSearch,(function(e){return Object(r["openBlock"])(),Object(r["createBlock"])("option",{key:e.value,value:e.value},Object(r["toDisplayString"])(e.text),9,["value"])})),128))],512),[[r["vModelSelect"],e.typeSearch]])]),Object(r["createVNode"])("td",null,[Object(r["withDirectives"])(Object(r["createVNode"])("select",{"onUpdate:modelValue":t[2]||(t[2]=function(t){return e.typeCompare=t})},[(Object(r["openBlock"])(!0),Object(r["createBlock"])(r["Fragment"],null,Object(r["renderList"])(e.optionsTypeCompare,(function(e){return Object(r["openBlock"])(),Object(r["createBlock"])("option",{key:e.value,value:e.value},Object(r["toDisplayString"])(e.text),9,["value"])})),128))],512),[[r["vModelSelect"],e.typeCompare]])]),Object(r["createVNode"])("td",null,[Object(r["withDirectives"])(Object(r["createVNode"])("input",{"onUpdate:modelValue":t[3]||(t[3]=function(t){return e.filterValue=t}),placeholder:"edit me"},null,512),[[r["vModelText"],e.filterValue]])])])])])}var Ue=function(e){Object(j["a"])(n,e);var t=Object(k["a"])(n);function n(){return Object(m["a"])(this,n),t.apply(this,arguments)}return n}(w["b"]);Ue=Object(S["a"])([Object(w["a"])({props:{attribute:Object},methods:{},data:function(){return{typeSearch:"A",optionsTypeSearch:[{text:"Exact",value:"A"},{text:"Regex",value:"B"}],typeCompare:"A",optionsTypeCompare:[{text:"=",value:"A"},{text:"!=",value:"B"}],filterValue:""}}})],Ue);var Fe=Ue;Fe.render=Le;var Ge=Fe,Je={id:"askomics-text-box"};function We(e,t,n,i,a,o){return Object(r["openBlock"])(),Object(r["createBlock"])("div",Je,[Object(r["createVNode"])("table",null,[Object(r["createVNode"])("tr",null,[Object(r["createVNode"])("td",null,[Object(r["withDirectives"])(Object(r["createVNode"])("select",{"onUpdate:modelValue":t[1]||(t[1]=function(t){return e.operator=t})},[(Object(r["openBlock"])(!0),Object(r["createBlock"])(r["Fragment"],null,Object(r["renderList"])(e.optionsOprator,(function(e){return Object(r["openBlock"])(),Object(r["createBlock"])("option",{key:e.value,value:e.value},Object(r["toDisplayString"])(e.text),9,["value"])})),128))],512),[[r["vModelSelect"],e.operator]])]),Object(r["createVNode"])("td",null,[Object(r["withDirectives"])(Object(r["createVNode"])("input",{"onUpdate:modelValue":t[2]||(t[2]=function(t){return e.filterValue=t}),placeholder:"edit me"},null,512),[[r["vModelText"],e.filterValue]])])])])])}var ze=function(e){Object(j["a"])(n,e);var t=Object(k["a"])(n);function n(){return Object(m["a"])(this,n),t.apply(this,arguments)}return n}(w["b"]);ze=Object(S["a"])([Object(w["a"])({props:{attribute:Object},methods:{},data:function(){return{operator:"=",optionsOprator:[{text:"=",value:"="},{text:"<",value:"<"},{text:">",value:">"},{text:">=",value:">="},{text:"!=",value:"!="}],filterValue:""}}})],ze);var Qe=ze;Qe.render=We;var $e=Qe;[te["d"],te["g"],te["a"],te["e"],te["b"],te["c"]].map((function(e){return ee["c"].add(e)}));var Ye=function(e){Object(j["a"])(n,e);var t=Object(k["a"])(n);function n(){return Object(m["a"])(this,n),t.apply(this,arguments)}return n}(w["b"]);Ye=Object(S["a"])([Object(w["a"])({components:{library:ee["c"],FontAwesomeIcon:ne["a"],XsdString:Ge,XsdNumeric:$e,URIBox:Ae},emits:["updateAttribute"],props:{attribute:{type:Object,required:!0}},methods:{toggleLinkAttribute:function(){console.log("click 1 !")},openEye:function(){this.attributeInt.visible=!0,this.$emit("updateAttribute",JSON.stringify(this.attributeInt))},closeEye:function(){this.attributeInt.visible=!1,this.$emit("updateAttribute",JSON.stringify(this.attributeInt))},openLink:function(){this.attributeInt.linked=!0,this.$emit("updateAttribute",JSON.stringify(this.attributeInt))},closeLink:function(){this.attributeInt.linked=!1,this.$emit("updateAttribute",JSON.stringify(this.attributeInt))},toggleOptional:function(){console.log("click 3 !")}},data:function(){return{attributeInt:this.attribute}}})],Ye);var Ke=Ye;n("0c2c");Ke.render=_e;var Xe=Ke,He=function(e){Object(j["a"])(n,e);var t=Object(k["a"])(n);function n(){return Object(m["a"])(this,n),t.apply(this,arguments)}return n}(w["b"]);He=Object(S["a"])([Object(w["a"])({name:"AttributesPanel",emits:["updateRequestManager","updateFilterProperty"],components:{AttributeBox:Xe},props:{requestString:{type:String,required:!0},width:Number,height:Number},mounted:function(){this.updateRequestString(this.requestString);var e=document.querySelector(".attributesList");e&&(e.style.height=this.height+"px",e.style.width=this.width+"px")},watch:{requestString:function(e){console.log("receive!!!"),this.updateRequestString(e)},selected_filterProperty:function(e){this.$emit("updateFilterProperty",JSON.stringify(e))}},data:function(){return{propertyFilterList:[{id:O.TO,label:"TO"},{id:O.FROM,label:"FROM"},{id:O.IS_A,label:"IS_A"},{id:O.ALL,label:"ALL"}],request:null,selected_filterProperty:O.TO,attributeList:[]}},computed:{displayCommonAttributeButtons:function(){return!!this.request&&this.request.focusIsSelected()},displayRemoveButton:function(){return!!this.request&&(this.request.focusIsSelected()&&!this.request.isFocusStart())}},methods:{updateRequestString:function(e){var t=this;this.request=new fe(e),this.request.focusIsSelected()?ve.buildAttributesBox(this.request).then((function(e){t.attributeList=e})):this.attributeList=[]},removeNode:function(){this.request.removeNode(this),this.$emit("updateRequestManager",this.request.serialized())},updateAttribute:function(e){this.request.updateAttribute(JSON.parse(e)),this.$emit("updateRequestManager",this.request.serialized())}}})],He);var Ze=He;n("4023");Ze.render=Ce;var et=Ze;[te["f"]].map((function(e){return ee["c"].add(e)}));var tt=function(e){Object(j["a"])(n,e);var t=Object(k["a"])(n);function n(){return Object(m["a"])(this,n),t.apply(this,arguments)}return n}(w["b"]);tt=Object(S["a"])([Object(w["a"])({name:"QueryBuilder",components:{library:ee["c"],FontAwesomeIcon:ne["a"],QueryGraphPanel:me,AttributesPanel:et},emits:["updateQuery"],props:{query:String},data:function(){return{currentQuery:this.query,requestBusy:!1,requestBusyPercent:"0",requestBusyEvent:"",filterProperty:O.TO}},watch:{requestBusy:"prepareRequestBusy",requestBusyPercent:"prepareRequestBusy"},methods:{prepareRequestBusy:function(){this.requestBusy&&"100"!=this.requestBusyPercent||(this.requestBusyPercent="0",this.requestBusyEvent="")},updateQuery:function(e){this.currentQuery=e,this.$emit("updateQuery",e)},attributeBoxEvent:function(e){console.log("attributeBoxEvent:",e)},getResults:function(){Ft.push({name:"results",params:{rm:this.currentQuery}})},back:function(){},forward:function(){}}})],tt);var nt=tt;nt.render=Z;var rt=nt,it=function(e){Object(j["a"])(n,e);var t=Object(k["a"])(n);function n(){return Object(m["a"])(this,n),t.apply(this,arguments)}return n}(w["b"]);it=Object(S["a"])([Object(w["a"])({name:"AskOmicsView",components:{QueryBuilder:rt},emits:["updateDiscovery"],computed:{query:function(){return this.$route.params.query}},methods:{updateQuery:function(e){var t=JSON.parse(e);this.$emit("updateDiscovery",t[2])}}})],it);var at=it;n("8fd5");at.render=T;var ot=at;function st(e,t,n,i,a,o){var s=Object(r["resolveComponent"])("ResultsPanel");return Object(r["openBlock"])(),Object(r["createBlock"])(s,{rm:e.rm},null,8,["rm"])}var ct={id:"results-panel"};function ut(e,t,n,i,a,o){var s=Object(r["resolveComponent"])("vue-table-lite");return Object(r["openBlock"])(),Object(r["createBlock"])("div",ct,[Object(r["createVNode"])(s,{"is-static-mode":e.isStaticMode,"has-checkbox":e.hasCheckbox,"is-loading":e.isLoading,"is-re-search":e.isReSearch,columns:e.columns,rows:e.rows,total:e.totalRecordCount,sortable:e.isSortable,messages:e.messages,onDoSearch:e.doSearch,onIsFinished:e.tableLoadingFinish,onReturnCheckedRow:e.updateCheckedRows},null,8,["is-static-mode","has-checkbox","is-loading","is-re-search","columns","rows","total","sortable","messages","onDoSearch","onIsFinished","onReturnCheckedRow"])])}n("07ac"),n("4e82");var lt=n("4154"),dt=n.n(lt),ht=function(e){Object(j["a"])(n,e);var t=Object(k["a"])(n);function n(){return Object(m["a"])(this,n),t.apply(this,arguments)}return n}(w["b"]);ht=Object(S["a"])([Object(w["a"])({name:"ResultsPanel",components:{VueTableLite:dt.a},props:{rm:{type:String,required:!1},isStaticMode:{type:Boolean,required:!1,default:!0},hasCheckbox:{type:Boolean,required:!1,default:!1},isSortable:{type:Object,required:!1,default:{order:"id",sort:"asc"}}},data:function(){return{laziestPages:[],rows:[],totalRecordCount:2,messages:{pagingInfo:"Showing {0}-{1} of {2}",pageSizeChangeLabel:"Row count:",gotoPageLabel:"Go to page:",noDataAvailable:"No data"},isLoading:!1,isReSearch:!1,isSortable:{order:"id",sort:"asc"}}},computed:{columns:function(){var e=new fe(this.rm).getColumnsResults();return this.resultsPage(0),e}},methods:{resultsPage:function(e,t){var n=this;new fe(this.rm).getCountAndLaziesPages(t).then((function(t){n.totalRecordCount=Object.values(t)[0];var r=Object.values(t)[1];n.totalRecordCount>0&&r.length>0&&r[e].commit().raw().then((function(t){n.rows=[];for(var r=new Map,i=function(i){var a={};a["id"]=10*e+i;var o=Object(ae["a"])(new Set(n.columns.filter((function(e){return e.node_id})).map((function(e){return e.node_id}))));o.forEach((function(e){r.set(e,t.results.bindings[i][e].value)})),n.columns.forEach((function(e){if(e.field!=e.node_id){var n="<undefined>",i=r.get(e.node_id);console.log(JSON.stringify(t.results.datatypes[e.field][i])),t.results.datatypes[e.field]&&t.results.datatypes[e.field][i]&&t.results.datatypes[e.field][i].length>0&&(n=t.results.datatypes[e.field][i][0].value),a[e.field]=n}})),n.rows.push(a)},a=0;a<t.results.bindings.length;a++)i(a)}))}))},doSearch:function(e,t,n,r){console.log("doSearch"),console.log(e,t,n,r),this.isLoading=!0,this.isReSearch=!!e,this.resultsPage(Math.floor(e/10),t);try{n&&(this.sortable.order=n)}catch(i){console.warn(i)}try{r&&(this.sortable.sort=r)}catch(i){console.warn(i)}},tableLoadingFinish:function(){console.log("tableLoadingFinish"),this.isLoading=!1},updateCheckedRows:function(){console.log("updateCheckedRows")}}})],ht);var pt=ht;pt.render=ut;var ft=pt,bt=function(e){Object(j["a"])(n,e);var t=Object(k["a"])(n);function n(){return Object(m["a"])(this,n),t.apply(this,arguments)}return n}(w["b"]);bt=Object(S["a"])([Object(w["a"])({name:"ResultsView",components:{ResultsPanel:ft},data:function(){return{}},computed:{rm:function(){return console.log(this.$route.params),this.$route.params.rm}},methods:{}})],bt);var gt=bt;gt.render=st;var yt=gt;function vt(e,t,n,i,a,o){var s=Object(r["resolveComponent"])("ConfigurationPanel");return Object(r["openBlock"])(),Object(r["createBlock"])(s,{configurations_list:e.config_list,configuration:e.configuration,"onUpdate:configuration":t[1]||(t[1]=function(t){return e.configuration=t})},null,8,["configurations_list","configuration"])}var Ot={id:"configuration-panel"},mt={class:"container"},jt=Object(r["createVNode"])("hr",null,null,-1),kt={class:"row"},St={class:"input-group mb-3"},wt={class:"input-group-prepend"},Nt={id:"browsers"},Ct={class:"row"},Et={class:"input-group mb-3"},Bt=Object(r["createVNode"])("div",null,[Object(r["createVNode"])("label",{class:"form-control",for:"sel1"},"Strategy:")],-1),xt={class:"form-check form-check-inline"},Dt=Object(r["createVNode"])("label",{class:"form-check-label",for:"strategyRequest"}," AskOmics ",-1),Rt={class:"form-check form-check-inline"},qt=Object(r["createVNode"])("label",{class:"form-check-label",for:"strategyRequest"}," Data-Driven ",-1);function _t(e,t,n,i,a,o){return Object(r["openBlock"])(),Object(r["createBlock"])("div",Ot,[Object(r["createVNode"])("div",mt,[jt,Object(r["createVNode"])("div",kt,[Object(r["createVNode"])("div",St,[Object(r["createVNode"])("div",wt,[Object(r["withDirectives"])(Object(r["createVNode"])("select",{"onUpdate:modelValue":t[1]||(t[1]=function(t){return e.selectedimetype=t}),class:"form-control"},[(Object(r["openBlock"])(!0),Object(r["createBlock"])(r["Fragment"],null,Object(r["renderList"])(e.optionsMimetype,(function(e){return Object(r["openBlock"])(),Object(r["createBlock"])("option",{key:e.text,value:e.value},Object(r["toDisplayString"])(e.text),9,["value"])})),128))],512),[[r["vModelSelect"],e.selectedimetype]])]),Object(r["withDirectives"])(Object(r["createVNode"])("input",{type:"text","onUpdate:modelValue":t[2]||(t[2]=function(t){return e.selectedEndpoint=t}),class:"form-control",onChange:t[3]||(t[3]=function(){return e.updateConfiguration&&e.updateConfiguration.apply(e,arguments)}),placeholder:"http://",list:"browsers","aria-label":"Endpoint"},null,544),[[r["vModelText"],e.selectedEndpoint]]),Object(r["createVNode"])("datalist",Nt,[(Object(r["openBlock"])(!0),Object(r["createBlock"])(r["Fragment"],null,Object(r["renderList"])(e.configurationsList,(function(e){return Object(r["openBlock"])(),Object(r["createBlock"])("option",{key:e,value:e.endpoint},null,8,["value"])})),128))])])]),Object(r["createVNode"])("div",Ct,[Object(r["createVNode"])("div",Et,[Bt,Object(r["createVNode"])("div",xt,[Object(r["withDirectives"])(Object(r["createVNode"])("input",{name:"strategyRequest",value:"askomics",class:"form-check-input",type:"radio","onUpdate:modelValue":t[4]||(t[4]=function(t){return e.selectedStrategy=t}),onChange:t[5]||(t[5]=function(){return e.updateConfiguration&&e.updateConfiguration.apply(e,arguments)})},null,544),[[r["vModelRadio"],e.selectedStrategy]]),Dt]),Object(r["createVNode"])("div",Rt,[Object(r["withDirectives"])(Object(r["createVNode"])("input",{name:"strategyRequest",value:"data-driven",class:"form-check-input",type:"radio","onUpdate:modelValue":t[6]||(t[6]=function(t){return e.selectedStrategy=t}),onChange:t[7]||(t[7]=function(){return e.updateConfiguration&&e.updateConfiguration.apply(e,arguments)})},null,544),[[r["vModelRadio"],e.selectedStrategy]]),qt])])])])])}var Pt=function(e){Object(j["a"])(n,e);var t=Object(k["a"])(n);function n(){return Object(m["a"])(this,n),t.apply(this,arguments)}return n}(w["b"]);Pt=Object(S["a"])([Object(w["a"])({name:"ConfigurationPanel",components:{},emits:["updateConfiguration"],props:{configuration:Object,configurationsList:{type:Array,default:function(){return[{title:"PeakForest",endpoint:"https://peakforest.semantic-metabolomics.fr/sparql",type:"url",mimetype:"application/sparql-query"},{title:"Metabolomics Endpoint - Metabolights",endpoint:"https://metabolights.semantic-metabolomics.fr/sparql",type:"url",mimetype:"application/sparql-query"},{title:"Genostack - Metabolights",endpoint:"https://askomics-metabolights-192-168-100-98.vm.openstack.genouest.org/virtuoso/sparql",type:"url",mimetype:"application/sparql-query"},{title:"Rhea - expert-curated knowledgebase of chemical and transport reactions of biological interest",endpoint:"https://sparql.rhea-db.org/sparql",type:"url",mimetype:"application/sparql-query"},{title:"KEGG - Kyoto Encyclopedia of Genes and Genomes",endpoint:"https://www.genome.jp/oc/proxy/sparql",type:"url",mimetype:"application/sparql-query"},{title:"Mesh Term",endpoint:"https://id.nlm.nih.gov/mesh/sparql",type:"url",mimetype:"application/sparql-query"},{title:"MetaNetX - Automated Model Construction and Genome Annotation for Large-Scale Metabolic Networks",endpoint:"https://rdf.metanetx.org/sparql",type:"url",mimetype:"application/sparql-query"},{title:"Metabolights_studies.ttl",endpoint:"https://raw.githubusercontent.com/p2m2/database-files/master/ttl/Metabolights_studies.ttl",type:"file",mimetype:"text/turtle"},{title:"Metabolights_studies_askomics.ttl",endpoint:"https://raw.githubusercontent.com/p2m2/database-files/master/ttl/Metabolights_studies_askomics.ttl",type:"file",mimetype:"text/turtle"},{title:"DBPedia",endpoint:"https://dbpedia.org/sparql/",type:"url",mimetype:"application/sparql-query"}]}},strategy:{type:String,default:"data-driven"}},data:function(){return{selectedimetype:"application/sparql-query",optionsMimetype:[{text:"SPARQL",value:"application/sparql-query"},{text:"Turtle",value:"B"}],selectedStrategy:this.strategy,selectedEndpoint:""}},mounted:function(){this.selectedimetype=this.configuration.mimetype,this.selectedEndpoint=this.configuration.url,this.selectedStrategy=this.configuration.strategy},methods:{getUserConfiguration:function(e){var t=new B(e.title);switch(t.mimetype=e.mimetype,e.type){case"url":t.url=e.endpoint;break;case"file":t.file=e.endpoint;break;case"content":t.content=e.endpoint;break;default:t.url=e.endpoint}return t},updateConfiguration:function(e){var t=this;console.log("update:",e);var n,r=this.configurationsList.filter((function(e){return e.endpoint==t.selectedEndpoint}));r.length>0?n=this.getUserConfiguration(r[0]):(n=new B("defined-by-user"),n.url=this.selectedEndpoint,n.mimetype=this.selectedimetype),n.strategy=this.selectedStrategy,this.$emit("updateConfiguration",JSON.stringify(n))}}})],Pt);var Vt=Pt;Vt.render=_t;var Mt=Vt,Tt=function(e){Object(j["a"])(n,e);var t=Object(k["a"])(n);function n(){return Object(m["a"])(this,n),t.apply(this,arguments)}return n}(w["b"]);Tt=Object(S["a"])([Object(w["a"])({name:"ConfigurationView",components:{ConfigurationPanel:Mt},data:function(){return{config_list:[]}},computed:{configuration:function(){return B.build(JSON.parse(this.$route.params.configuration))}},methods:{}})],Tt);var At=Tt;At.render=vt;var It=At,Lt=[{path:"/",name:"app",component:ot},{path:"/askomics/:query",name:"askomics",component:ot},{path:"/results/:rm",name:"results",component:yt},{path:"/configuration/:configuration",name:"configuration",component:It}],Ut=Object(M["a"])({history:Object(M["b"])("/askomics-queryview/"),routes:Lt}),Ft=Ut;Object(r["createApp"])(V).use(Ft).mount("#app")},e3f0:function(e,t,n){"use strict";n("7b2c")}});
//# sourceMappingURL=app.2e7ca730.js.map